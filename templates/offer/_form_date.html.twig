{#{{ form_start(form) }}#}

{#<div class="form-control mb-3">#}
{#    <div class="row">#}
{#        <div class="col-md-6">#}
{#            <div>#}
{#                {{ form_label(form.duration) }}#}
{#                {{ form_widget(form.duration) }}#}
{#            </div>#}
{#            <div class="row">#}
{#                <div class="col-md-6">#}
{#                    {{ form_label(form.price) }}#}
{#                    {{ form_widget(form.price) }}#}
{#                </div>#}
{#                <div class="col-md-6">#}
{#                    {{ form_label(form.currentVat) }}#}
{#                    {{ form_widget(form.currentVat) }}#}
{#                </div>#}
{#            </div>#}
{#            <div class="col-md-12">#}
{#                {{ form_label(form.capacity) }}#}
{#                {{ form_widget(form.capacity) }}#}
{#            </div>#}
{#        </div>#}
{#        <div class="col-md-6">#}
{#            <ul class="calendars" data-prototype="{{ form_widget(form.calendars.vars.prototype)|e('html_attr') }}">#}
{#                {% for calendar in form.calendars %}#}
{#                    {{ form_label(calendar.startAt) }}#}
{#                    {{ form_widget(calendar.startAt) }}#}
{#                {% endfor %}#}
{#            </ul>#}
{#            <button type="button" class="add_item_link" data-collection-holder-class="calendars">New date#}
{#            </button>#}
{#        </div>#}
{#    </div>#}
{#    </div>#}
{#<h3>{{ form_label(form.calendars) }}</h3>#}
{#<ul class="tags" data-prototype="{{ form_widget(form.calendars.vars.prototype)|e('html_attr') }}">#}
{#    {% for calendar in form.calendars %}#}
{#        <li>#}
{#            {{ form_row(calendar.startAt) }} {{ form_row(calendar.delete) }}#}
{#        </li>#}
{#    {% endfor %}#}
{#</ul>#}
{#<button type="button" class="add_item_link" data-collection-holder-class="calendars">Add a tag</button>#}

{#    <script>#}
{#        function addFormToCollection($collectionHolderClass) {#}
{#            // Get the ul that holds the collection of tags#}

{#            let $collectionHolder = document.querySelector('.' + $collectionHolderClass);#}

{#            // Get the data-prototype explained earlier#}
{#            var prototype = $collectionHolder.getAttribute('data-prototype');#}

{#            // get the new index#}
{#            var index = parseInt($collectionHolder.getAttribute('index'));#}
{#            var newForm = prototype;#}
{#            // You need this only if you didn't set 'label' => false in your tags field in TaskType#}
{#            // Replace '__name__label__' in the prototype's HTML to#}
{#            // instead be a number based on how many items we have#}
{#            // newForm = newForm.replace(/__name__label__/g, index);#}

{#            // Replace '__name__' in the prototype's HTML to#}
{#            // instead be a number based on how many items we have#}
{#            newForm = newForm.replace(/__name__/g, index);#}

{#            // increase the index with one for the next item#}
{#            $collectionHolder.setAttribute('index', index + 1);#}

{#            // Display the form in the page in an li, before the "Add a tag" link li#}
{#            let $li = document.createElement('li');#}
{#            $li.innerHTML = newForm;#}
{#            // Add the new form at the end of the list#}
{#            $collectionHolder.appendChild($li)#}
{#        }#}

{#        document.addEventListener('DOMContentLoaded', function() {#}
{#            // Get the ul that holds the collection of tags#}
{#            let $tagsCollectionHolder = document.querySelector('ul.calendars');#}
{#            // count the current form inputs we have (e.g. 2), use that as the new#}
{#            // index when inserting a new item (e.g. 2)#}
{#            let $index = $calendarsCollectionHolder.querySelectorAll('input').length#}
{#            $calendarsCollectionHolder.setAttribute('index', $index);#}

{#            let $buttons = document.querySelectorAll('.add_item_link');#}
{#            $buttons.forEach(function($button){#}
{#                $button.addEventListener('click', function(e) {#}
{#                    let $collectionHolderClass = e.target.getAttribute('data-collection-holder-class');#}
{#                    // add a new tag form (see next code block)#}
{#                    addFormToCollection($collectionHolderClass);#}
{#                })#}
{#            })#}

{#        });#}
{#    </script>#}
